% $Id$
\documentclass[a4paper,12pt,draft]{article}

% Useful stuff for math mode.
\usepackage{amstext}
% Wrapping of URLs; this doesn't work in the bibliography, but the breakurl
% package does.
%\usepackage{url}
% The name of the program, so I only have to change it in one place.
\newcommand{\parsername}{\PLP{}}
\newcommand{\parsernames}{\PLP{}'s}
% Include images
\usepackage[final]{graphicx}
% Change how nested enumerate environments are labelled.
\renewcommand{\labelenumii}{\roman{enumii}:}
\renewcommand{\refname}{Bibliography}
% Add the bibliography into the table of contents.
\usepackage[section,numbib]{tocbibind}
% Provides commands to distinguish between pdf and dvi output.
\usepackage{ifpdf}

\usepackage[acronym=true,style=altlist,number=none,toc=true]{glossary}
\makeglossary{}
\makeacronym{}

% When creating a \PDF{} make the table of contents into links to the pages
% (without horrible red borders) and include bookmarks.  The title and
% author don't work - I think either gnuplot or graphviz clobbers it.
% hyperfootnotes need to be disabled to avoid breaking footmisc, but they
% still seem to work, somehow.
\ifpdf{}
    \usepackage[pdftex,hyperfootnotes=false]{hyperref}
\else{}
    \usepackage[dvips,hyperfootnotes=false]{hyperref}
\fi{}
\hypersetup{
    pdftitle    = {Parsing Postfix log files},
    pdfauthor   = {John Tobin},
    final       = true,
    pdfborder   = {0 0 0},
%    breaklinks  = true,
}
% This is necessary for URLs in the bibliography; I dunno why the url
% package doesn't work; don't include it when generating \PDF{} output.
\ifpdf{}
\else{}
    \usepackage{breakurl}
\fi{}
\usepackage{lastpage}

% Extra footnote functionality, including references to earlier footnotes.
\usepackage{footmisc}

% \showgraph{filename}{caption}{label}
\newcommand{\showgraph}[3]{
    \begin{figure}[hbt!]
        \caption{#2}\label{#3}
        \includegraphics{#1}
    \end{figure}
}

%\showtable{filename}{caption}{label}
\newcommand{\showtable}[3]{
    \begin{table}[ht]
        \caption{#2}\label{#3}
        \input{#1}
    \end{table}
}

% Replacement for \ref{}, adds the page number too.
\newcommand{\refwithpage}[1]{%
    \empty{}\ref{#1} [page~\pageref{#1}]%
}
% section references, automatically add \textsection
\newcommand{\sectionref}[1]{%
    \textsection{}\refwithpage{#1}%
}

% A command to format a Postfix daemon's name
\newcommand{\daemon}[1]{%
    \texttt{postfix/#1}%
}

% This is ridiculous, but I can't put @ in glossary entries, so . . .
\newcommand{\at}[0]{%
    @%
}

\newcommand{\tab}[0]{%
    \hspace*{2em}%
}

\newcommand{\numberOFlogFILES}[0]{%
    93%
}

\newcommand{\numberOFrules}[0]{%
    165%
}

\newcommand{\numberOFlogLINES}[0]{%
    60,721,709%
}

\newcommand{\numberOFlogLINEShuman}[0]{%
    60.72 million%
}

% This may keep hyperref happy about the Abstract entry in the table of
% contents.
\newcounter{dummy}

\begin{document}

% Pull in the acronyms early, so they can be used throughout the text.
\input{logparser-acronyms.tex}

\title{Parsing Postfix log files}
\author{John Tobin \\ School of Computer Science and Statistics \\
Trinity College \\ Dublin 2 \\ Ireland \\ tobinjt@cs.tcd.ie}
\maketitle

\refstepcounter{dummy}
\addcontentsline{toc}{section}{Abstract}
\begin{abstract}

    Parsing Postfix logs is much more difficult than it first appears, but
    it \textit{is\/} possible to achieve a high degree of accuracy in
    understanding the logs, and thus accuracy in reconstructing the actions
    taken by Postfix to generate the logs.  This paper describes the
    creation of a parser, documenting the parsing algorithm, explaining the
    difficulties encountered and the solutions developed, with reference to
    an implementation which stores data gleaned from the logs in an SQL
    database.  The gathered data can then be used to optimise current
    anti-spam measures, provide a baseline to test new anti-spam measures
    against, or to produce statistics showing how effective those measures
    are.

\end{abstract}

XXX POSSIBLE CONFERENCES\@: AICS'S AI-2008 IN CORK, AND SGAI IN CAMBRIDGE
IN DECEMBER\@.

XXX UPDATE THE RULES TABLE EVERYWHERE\@.

XXX CLUSTERING\@: BIRCH BY MARK O'NEILL\@.

XXX TEST OTHER PARSERS ON THE 93 TEST LOG FILES\@:

\begin{enumerate}
    \item Log Mail Analyser
\end{enumerate}

\newpage
\tableofcontents
\listoffigures
\listoftables

\newpage
\input{logparser-introduction.tex}
\input{logparser-background.tex}
\input{logparser-database-schema.tex}
\input{logparser-parsing-rules.tex}
\input{logparser-parsing-algorithm.tex}
\input{logparser-coverage.tex}
\input{logparser-limitations.tex}
\input{logparser-conclusion.tex}
\input{logparser-other-parsers-review.tex}

\bibliographystyle{logparser-bibliography-style}
\bibliography{logparser-bibliography}
\label{bibliography}

\input{logparser-graphs.tex}

% Redefine the command used to produce the glossary title, because the
% default command produces an unnumbered section whereas I want a numbered
% section.
\renewcommand{\glossarytitle}{\section{Glossary}\label{Glossary}}
\printglossary{}
% Redefine the command a second time to produce acronyms instead of a
% glossary.
\renewcommand{\glossarytitle}{\section{Acronyms}\label{Acronyms}}
\printacronym{}

\input{logparser-glossary.tex}
% logparser-acronyms.tex has been included in the preamble so that the
% commands are available throughout the text.
\end{document}
